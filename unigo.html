<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UniGo - –ü–æ–µ–∑–¥–∫–∏ –¥–æ –≤—É–∑–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom right, #fff9c4, #ffecb3);
      opacity: 0;
      animation: fadeInBody 1s forwards;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    @keyframes fadeInBody {
      to { opacity: 1; }
    }

    .fade-in {
      animation: fadeIn 0.5s forwards;
    }

    .fade-out {
      animation: fadeOut 0.5s forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    .container {
      width: 80vw;
      height: 45vw;
      max-width: 800px;
      max-height: 450px;
      margin: 20px auto;
      background: white;
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
      position: relative;
      overflow-y: auto;
    }

    #profileView {
      height: 60vw;
      max-height: 600px;
    }

    h1, h2 {
      text-align: center;
      color: #f57c00;
      padding: 0 50px;
      margin-top: 10px;
      box-sizing: border-box;
    }

    .logo {
      text-align: center;
      font-size: 36px;
      font-weight: bold;
      color: #ff8f00;
      margin-bottom: 10px;
    }

    input, button, label, a, textarea, select {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ffcc80;
      border-radius: 10px;
      box-sizing: border-box;
    }

    button {
      background-color: #ffb300;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #ff8f00;
    }

    .back-button {
      position: absolute;
      top: 15px;
      left: 15px;
      background: transparent;
      border: none;
      font-size: 24px;
      color: #ff8f00;
      cursor: pointer;
      z-index: 10;
      width: 40px;
      height: 40px;
      margin: 0;
      padding: 0;
    }

    .profile-button {
      position: absolute;
      top: 15px;
      right: 15px;
      background: transparent;
      border: none;
      font-size: 24px;
      color: #ff8f00;
      cursor: pointer;
      z-index: 10;
      width: 40px;
      height: 40px;
      margin: 0;
      padding: 0;
    }

    #map, .map-container {
      width: 100%;
      height: 200px;
      border-radius: 10px;
      margin-bottom: 10px;
      border: 1px solid #ffcc80;
    }

    .alert-button {
      background-color: #ff5722;
      color: white;
      font-size: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      position: fixed;
      bottom: 20px;
      right: 20px;
      border: none;
    }

    .chat-box {
      display: none;
      border: 1px solid #ffcc80;
      background: white;
      padding: 20px;
      border-radius: 20px;
      margin: 20px auto;
      max-width: 500px;
      box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
    }

    .chat-messages {
      height: 200px;
      overflow-y: auto;
      background: #fffde7;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
      border: 1px solid #ffecb3;
    }

    .rating-stars {
      color: #FFD700;
      margin-bottom: 10px;
      text-align: center;
      font-size: 24px;
    }

    footer {
      text-align: center;
      padding: 20px;
      color: #ff8f00;
      font-weight: bold;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    #agreementModal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      z-index: 999;
    }

    #agreementModalContent {
      background: #fff;
      margin: 5% auto;
      padding: 20px;
      width: 90%;
      max-width: 600px;
      border-radius: 10px;
      position: relative;
      border: 2px solid #ffb300;
    }

    .profile-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-color: #ffecb3;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      color: #ff8f00;
      margin-right: 20px;
      border: 2px solid #ffb300;
    }

    .profile-info {
      flex-grow: 1;
    }

    .profile-menu {
      list-style: none;
      padding: 0;
    }

    .profile-menu li {
      padding: 10px;
      border-bottom: 1px solid #ffecb3;
    }

    .profile-menu li:last-child {
      border-bottom: none;
    }

    .profile-menu a {
      text-decoration: none;
      color: #ff8f00;
      display: block;
      font-weight: bold;
    }

    .profile-menu a:hover {
      color: #ff5722;
    }

    .map-small {
      height: 150px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #ffcc80;
    }

    .auto-reply-settings {
      margin-top: 20px;
      padding: 15px;
      background: #fffde7;
      border-radius: 10px;
      border: 1px solid #ffecb3;
    }
    
    .auto-reply-toggle {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .auto-reply-toggle label {
      margin-left: 10px;
      width: auto;
    }
    
    .auto-reply-text {
      width: 100%;
      min-height: 80px;
    }

    .city-selection {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .city-select {
      flex: 1;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ffcc80;
      background: white;
    }
    
    .find-button {
      background-color: #ff8f00;
      color: white;
    }

    .payment-methods {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 15px 0;
    }
    
    .payment-method {
      border: 2px solid #ffecb3;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .payment-method:hover {
      border-color: #ffb300;
      background: #fffde7;
    }
    
    .payment-method.selected {
      border-color: #ff8f00;
      background: #ffecb3;
    }
    
    .payment-icon {
      font-size: 24px;
      margin-bottom: 5px;
    }
    
    .tariff-selection {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin: 15px 0;
    }
    
    .tariff-option {
      border: 2px solid #ffecb3;
      border-radius: 10px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .tariff-option:hover {
      border-color: #ffb300;
      background: #fffde7;
    }
    
    .tariff-option.selected {
      border-color: #ff8f00;
      background: #ffecb3;
    }
    
    .tariff-title {
      font-weight: bold;
      color: #ff8f00;
      margin-bottom: 5px;
    }
    
    .tariff-price {
      font-size: 18px;
      font-weight: bold;
      color: #f57c00;
    }
    
    .tariff-desc {
      font-size: 14px;
      color: #666;
      margin-top: 5px;
    }

    .university-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 15px 0;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .university-option {
      border: 1px solid #ffcc80;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      text-align: center;
      background: white;
      transition: all 0.3s;
    }
    
    .university-option:hover {
      background: #fffde7;
      border-color: #ffb300;
    }
    
    .university-option.selected {
      background: #ffecb3;
      border-color: #ff8f00;
    }

    @media (max-width: 768px) {
      .container {
        width: 95vw;
        height: 53.5vw;
        max-height: none;
        margin: 10px auto;
      }
      
      #profileView {
        height: 80vh;
        max-height: none;
      }
      
      #map, .map-container {
        height: 150px;
      }
      
      .payment-methods {
        grid-template-columns: 1fr;
      }
      
      .university-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div id="roleSelection" class="container">
    <div class="logo">UniGo</div>
    <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</h2>
    <button onclick="selectRole('passenger')">–Ø —Å—Ç—É–¥–µ–Ω—Ç</button>
    <button onclick="selectRole('driver')">–Ø –≤–æ–¥–∏—Ç–µ–ª—å</button>
  </div>

  <div id="authForm" class="container" style="display:none;">
    <button class="back-button" onclick="backToRoleSelection()">‚Üê</button>
    <div class="logo">UniGo</div>
    <h2>–í—Ö–æ–¥ –∏–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input type="tel" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" id="phone">
    <input type="password" placeholder="–ü–∞—Ä–æ–ª—å" id="password">
    <a href="#" style="color: #ff8f00; text-align: center;">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
    <button onclick="login()">–í–æ–π—Ç–∏</button>
    <button onclick="registerStart()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
  </div>

  <div id="registerForm" class="container" style="display:none;">
    <button class="back-button" onclick="goBack('authForm')">‚Üê</button>
    <div class="logo">UniGo</div>
    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input type="text" placeholder="–§–ò–û" id="fullName">
    <input type="tel" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" id="regPhone">
    <input type="password" placeholder="–ü–∞—Ä–æ–ª—å" id="regPassword">
    
    <h3>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –≤—É–∑ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</h3>
    <div class="university-grid" id="universitySelection">
      <!-- –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
    </div>
    
    <label style="color: #ff8f00;">
      <input type="checkbox" id="agreementCheckbox"> –Ø –ø—Ä–∏–Ω–∏–º–∞—é <a href="#" onclick="openAgreement(event)" style="color: #ff8f00;">–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
    </label>
    <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
  </div>

  <div id="tariffSelection" class="container" style="display:none;">
    <button class="back-button" onclick="goBack('authForm')">‚Üê</button>
    <div class="logo">UniGo</div>
    <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ</h2>
    <p style="text-align: center; color: #666;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∞—Ä–∏—Ñ –¥–ª—è –ø–æ–µ–∑–¥–æ–∫ –¥–æ –≤—É–∑–∞</p>
    
    <div class="tariff-selection">
      <div class="tariff-option" onclick="selectTariff(1, 5000, '–ü–æ–º–µ—Å—è—á–Ω—ã–π')">
        <div class="tariff-title">üìÖ –ü–æ–º–µ—Å—è—á–Ω—ã–π</div>
        <div class="tariff-price">5 000 —Ç–≥/–º–µ—Å—è—Ü</div>
        <div class="tariff-desc">–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–µ–∑–¥–æ–∫ –¥–æ –≤–∞—à–µ–≥–æ –≤—É–∑–∞</div>
      </div>
      
      <div class="tariff-option" onclick="selectTariff(7, 3000, '7 –ø–æ–µ–∑–¥–æ–∫')">
        <div class="tariff-title">üé´ 7 –ø–æ–µ–∑–¥–æ–∫</div>
        <div class="tariff-price">3 000 —Ç–≥</div>
        <div class="tariff-desc">7 –ø–æ–µ–∑–¥–æ–∫ –¥–æ –≤—É–∑–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞</div>
      </div>
      
      <div class="tariff-option" onclick="selectTariff(16, 6000, '16 –ø–æ–µ–∑–¥–æ–∫')">
        <div class="tariff-title">üé´ 16 –ø–æ–µ–∑–¥–æ–∫</div>
        <div class="tariff-price">6 000 —Ç–≥</div>
        <div class="tariff-desc">16 –ø–æ–µ–∑–¥–æ–∫ –¥–æ –≤—É–∑–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞ (—ç–∫–æ–Ω–æ–º–∏—è 20%)</div>
      </div>
    </div>
    
    <div id="selectedTariffInfo" style="display:none; background: #ffecb3; padding: 15px; border-radius: 10px; margin: 15px 0;">
      <h3>–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞—Ä–∏—Ñ: <span id="selectedTariffName"></span></h3>
      <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="selectedTariffPrice"></span> —Ç–≥</p>
      <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–µ–∑–¥–æ–∫: <span id="selectedTariffTrips"></span></p>
    </div>
    
    <button onclick="confirmTariff()" id="confirmTariffBtn" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
  </div>

  <div id="mapView" class="container" style="display:none;">
    <button class="back-button" onclick="goBack('tariffSelection')">‚Üê</button>
    <button class="profile-button" onclick="showProfile()">üë§</button>
    <div class="logo">UniGo</div>
    <h2>–ü–æ–∏—Å–∫ –ø–æ–µ–∑–¥–æ–∫</h2>
    
    <div class="city-selection">
      <select id="fromLocation" class="city-select">
        <option value="">–û—Ç–∫—É–¥–∞</option>
        <option value="jastar">–ñ–∞—Å—Ç–∞—Ä –∞–ø–∞—Ä—Ç–º–µ–Ω—Å</option>
        <option value="almayu">–ê–ª–º–∞—é</option>
        <option value="dorm1">–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ1</option>
        <option value="dorm3">–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ3</option>
        <option value="dorm5">–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ5</option>
        <option value="center">–¶–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞</option>
        <option value="railway">–ñ/–¥ –≤–æ–∫–∑–∞–ª</option>
      </select>
      
      <select id="toUniversity" class="city-select">
        <option value="">–í –∫–∞–∫–æ–π –≤—É–∑</option>
        <option value="kaznu">–ö–∞–∑–ù–£ –∏–º. –∞–ª—å-–§–∞—Ä–∞–±–∏</option>
        <option value="kaznuir">–ö–∞–∑–ù–£–ò–†</option>
        <option value="kazatu">–ö–∞–∑–ê–¢–£</option>
        <option value="kaznpu">–ö–∞–∑–ù–ü–£ –∏–º. –ê–±–∞—è</option>
        <option value="kaznmu">–ö–∞–∑–ù–ú–£</option>
        <option value="kaznlu">–ö–∞–∑–ù–õ–£</option>
        <option value="iitu">IITU</option>
        <option value="kbtu">AlmaU</option>
        <option value="suleyman">–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –°—É–ª–µ–π–º–∞–Ω–∞ –î–µ–º–∏—Ä–µ–ª—è</option>
      </select>
    </div>
    
    <button class="find-button" onclick="findRides()">–ù–∞–π—Ç–∏ –ø–æ–µ–∑–¥–∫–∏</button>
    
    <div class="rating-stars"‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</div>
    <div id="map"></div>
    <div id="availableRides"></div>
    <button class="alert-button" onclick="showAvailableDrivers()">!</button>
    <div id="driverList"></div>
  </div>

  <div id="createRide" class="container" style="display:none;">
    <button class="back-button" onclick="goBack('mapView')">‚Üê</button>
    <button class="profile-button" onclick="showProfile()">üë§</button>
    <div class="logo">UniGo</div>
    <h2>–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏</h2>
    <select id="driverFromLocation">
      <option value="">–û—Ç–∫—É–¥–∞ (—Ç–æ—á–∫–∞ —Å–±–æ—Ä–∞)</option>
      <option value="jastar">–ñ–∞—Å—Ç–∞—Ä –∞–ø–∞—Ä—Ç–º–µ–Ω—Å</option>
      <option value="almayu">–ê–ª–º–∞—é</option>
      <option value="center">–¶–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞</option>
    </select>
    
    <select id="driverToUniversity">
      <option value="">–í –∫–∞–∫–æ–π –≤—É–∑</option>
      <option value="kaznu">–ö–∞–∑–ù–£ –∏–º. –∞–ª—å-–§–∞—Ä–∞–±–∏</option>
      <option value="kaznuir">–ö–∞–∑–ù–£–ò–†</option>
      <option value="kazatu">–ö–∞–∑–ê–¢–£</option>
      <option value="kaznpu">–ö–∞–∑–ù–ü–£ –∏–º. –ê–±–∞—è</option>
    </select>
    
    <input type="text" placeholder="–ê–¥—Ä–µ—Å –º–µ—Å—Ç–∞ –æ–∂–∏–¥–∞–Ω–∏—è" id="pickupAddress">
    <div class="map-container" id="pickupMap"></div>
    <input type="datetime-local" id="rideTime">
    <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç" id="seats" min="1" max="7">
    <input type="number" placeholder="–¶–µ–Ω–∞ –∑–∞ –º–µ—Å—Ç–æ" id="price">
    <button onclick="publishRide()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ–µ–∑–¥–∫—É</button>
  </div>

  <div id="profileView" class="container" style="display:none;">
    <button class="back-button" onclick="goBackFromProfile()">‚Üê</button>
    <div class="profile-header">
      <div class="profile-avatar" id="userAvatar">U</div>
      <div class="profile-info">
        <h2 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
        <p id="userPhone">+7 XXX XXX XX XX</p>
        <p id="userUniversity" style="color: #ff8f00; font-size: 14px;">–í—É–∑ –Ω–µ –≤—ã–±—Ä–∞–Ω</p>
        <p id="userTariff" style="color: #f57c00; font-size: 14px; font-weight: bold;">–¢–∞—Ä–∏—Ñ –Ω–µ –≤—ã–±—Ä–∞–Ω</p>
      </div>
    </div>
    
    <ul class="profile-menu">
      <li><a href="#" onclick="showMyRides()">–ú–æ–∏ –ø–æ–µ–∑–¥–∫–∏</a></li>
      <li><a href="#" onclick="showPaymentMethods()">–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</a></li>
      <li><a href="#" onclick="showSettings()">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
      <li id="driverAutoReplyItem" style="display:none;"><a href="#" onclick="showAutoReplySettings()">–ê–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫</a></li>
      <li><a href="#" onclick="changeTariff()">–°–º–µ–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ</a></li>
      <li><a href="#" onclick="logout()">–í—ã–π—Ç–∏</a></li>
    </ul>
    
    <h3>–ú–æ–∏ –¥–∞–Ω–Ω—ã–µ</h3>
    <input type="text" id="profileName" placeholder="–§–ò–û">
    <input type="tel" id="profilePhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
    
    <div id="paymentMethodsSection" style="display:none;">
      <h3>–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</h3>
      <div class="payment-methods">
        <div class="payment-method" onclick="selectPayment('kaspi')">
          <div class="payment-icon">üí≥</div>
          <div>Kaspi Gold</div>
        </div>
        <div class="payment-method" onclick="selectPayment('halyk')">
          <div class="payment-icon">üè¶</div>
          <div>Halyk Bank</div>
        </div>
        <div class="payment-method" onclick="selectPayment('jusan')">
          <div class="payment-icon">üì±</div>
          <div>Jusan</div>
        </div>
        <div class="payment-method" onclick="selectPayment('cash')">
          <div class="payment-icon">üíµ</div>
          <div>–ù–∞–ª–∏—á–Ω—ã–µ</div>
        </div>
      </div>
    </div>
    
    <button onclick="updateProfile()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
    
    <div id="autoReplySettings" class="auto-reply-settings" style="display:none;">
      <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫–∞</h3>
      <div class="auto-reply-toggle">
        <input type="checkbox" id="autoReplyEnabled">
        <label for="autoReplyEnabled">–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫</label>
      </div>
      <textarea id="autoReplyMessage" class="auto-reply-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å—Ç—É–¥–µ–Ω—Ç–∞–º...">–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ! –Ø –ø–æ–¥—ä–µ–∑–∂–∞—é –∫ —Ç–æ—á–∫–µ —Å–±–æ—Ä–∞.</textarea>
      <button onclick="saveAutoReplySettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>
  </div>

  <div id="myRidesView" class="container" style="display:none;">
    <button class="back-button" onclick="goBack('profileView')">‚Üê</button>
    <div class="logo">UniGo</div>
    <h2>–ú–æ–∏ –ø–æ–µ–∑–¥–∫–∏</h2>
    <div id="ridesList">
      <div class="ride-item" style="border: 1px solid #ffcc80; padding: 15px; margin: 10px 0; border-radius: 10px;">
        <p><strong>–ñ–∞—Å—Ç–∞—Ä –∞–ø–∞—Ä—Ç–º–µ–Ω—Å ‚Üí –ö–∞–∑–ù–£</strong></p>
        <p>–î–∞—Ç–∞: 23.04.2025 08:30</p>
        <p>–°—Ç–∞—Ç—É—Å: –ó–∞–≤–µ—Ä—à–µ–Ω–æ</p>
        <p>–¢–∞—Ä–∏—Ñ: –ü–æ–º–µ—Å—è—á–Ω—ã–π</p>
        <div class="map-small" id="rideMap1"></div>
        <button onclick="viewRideDetails(1)">–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</button>
      </div>
      <div class="ride-item" style="border: 1px solid #ffcc80; padding: 15px; margin: 10px 0; border-radius: 10px;">
        <p><strong>–ê–ª–º–∞—é ‚Üí –ö–∞–∑–ù–ü–£</strong></p>
        <p>–î–∞—Ç–∞: 25.04.2025 14:00</p>
        <p>–°—Ç–∞—Ç—É—Å: –í –ø—É—Ç–∏</p>
        <p>–¢–∞—Ä–∏—Ñ: 7 –ø–æ–µ–∑–¥–æ–∫</p>
        <div class="map-small" id="rideMap2"></div>
        <button onclick="viewRideDetails(2)">–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</button>
      </div>
    </div>
  </div>

  <div class="chat-box" id="chatBox">
    <h2>–ß–∞—Ç —Å –≤–æ–¥–∏—Ç–µ–ª–µ–º</h2>
    <div class="chat-messages" id="chatMessages"></div>
    <input type="text" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>

  <div id="agreementModal">
    <div id="agreementModalContent">
      <h2>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ UniGo</h2>
      <p><strong>1. –û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è:</strong> —Å–µ—Ä–≤–∏—Å UniGo –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–µ–∑–¥–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–æ –≤—É–∑–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞.</p>
      <p><strong>2. –¢–∞—Ä–∏—Ñ—ã:</strong> –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ–º–µ—Å—è—á–Ω—ã–π —Ç–∞—Ä–∏—Ñ, –ø–∞–∫–µ—Ç—ã –Ω–∞ 7 –∏ 16 –ø–æ–µ–∑–¥–æ–∫.</p>
      <p><strong>3. –û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:</strong> –≤–æ–¥–∏—Ç–µ–ª–∏ –æ–±—è–∑–∞–Ω—ã —Å–æ–±–ª—é–¥–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Å—Ç—É–¥–µ–Ω—Ç—ã ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è.</p>
      <p><strong>4. –û–ø–ª–∞—Ç–∞:</strong> –¥–æ—Å—Ç—É–ø–Ω—ã Kaspi, Halyk, Jusan –∏ –Ω–∞–ª–∏—á–Ω—ã–µ.</p>
      <button onclick="closeAgreement()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <footer>UniGo - –ü–æ–µ–∑–¥–∫–∏ –¥–æ –≤—É–∑–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</footer>

  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
  <script>
    let currentUser = null;
    let maps = {};
    let chatPartner = null;
    let selectedUniversities = [];
    let selectedTariff = null;
    let selectedPayment = null;

    // –°–ø–∏—Å–æ–∫ –≤—É–∑–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞
    const universities = [
      {id: 'kaznu', name: '–ö–∞–∑–ù–£ –∏–º. –∞–ª—å-–§–∞—Ä–∞–±–∏', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'kaznuir', name: '–ö–∞–∑–ù–£–ò–†', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'kazatu', name: '–ö–∞–∑–ê–¢–£', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'kaznpu', name: '–ö–∞–∑–ù–ü–£ –∏–º. –ê–±–∞—è', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'kaznmu', name: '–ö–∞–∑–ù–ú–£', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'kaznlu', name: '–ö–∞–∑–ù–õ–£', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'iitu', name: 'IITU', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'almau', name: 'AlmaU', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'suleyman', name: '–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –°—É–ª–µ–π–º–∞–Ω–∞ –î–µ–º–∏—Ä–µ–ª—è', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'enu', name: '–ï–ù–£ –∏–º. –õ.–ù. –ì—É–º–∏–ª–µ–≤–∞', city: '–ù—É—Ä-–°—É–ª—Ç–∞–Ω'},
      {id: 'kazguu', name: '–ö–∞–∑–ì–Æ–£', city: '–ù—É—Ä-–°—É–ª—Ç–∞–Ω'},
      {id: 'kaznrtu', name: '–ö–∞–∑–ù–†–¢–£', city: '–ê–ª–º–∞—Ç—ã'},
      {id: 'kaznau', name: '–ö–∞–∑–ù–ê–£', city: '–ê–ª–º–∞—Ç—ã'}
    ];

    document.addEventListener('DOMContentLoaded', function() {
      initAllMaps();
      populateUniversities();
    });

    function populateUniversities() {
      const container = document.getElementById('universitySelection');
      universities.forEach(uni => {
        const div = document.createElement('div');
        div.className = 'university-option';
        div.textContent = uni.name;
        div.setAttribute('data-id', uni.id);
        div.onclick = function() {
          this.classList.toggle('selected');
          const id = this.getAttribute('data-id');
          if (this.classList.contains('selected')) {
            selectedUniversities.push(id);
          } else {
            selectedUniversities = selectedUniversities.filter(u => u !== id);
          }
        };
        container.appendChild(div);
      });
    }

    function initAllMaps() {
      ymaps.ready(function() {
        maps.mainMap = new ymaps.Map("map", {
          center: [43.238949, 76.889709],
          zoom: 12
        });
        
        maps.pickupMap = new ymaps.Map("pickupMap", {
          center: [43.238949, 76.889709],
          zoom: 15
        });
        
        maps.rideMap1 = new ymaps.Map("rideMap1", {
          center: [43.238949, 76.889709],
          zoom: 12
        });
        addRoute(maps.rideMap1, [43.238949, 76.889709], [43.235, 76.895]);
        
        maps.rideMap2 = new ymaps.Map("rideMap2", {
          center: [43.238949, 76.889709],
          zoom: 12
        });
        addRoute(maps.rideMap2, [43.245, 76.880], [43.240, 76.890]);
      });
    }

    function addRoute(map, from, to) {
      ymaps.route([from, to]).then(function(route) {
        map.geoObjects.add(route);
      });
    }

    function fadeTo(fromId, toId) {
      const from = document.getElementById(fromId);
      const to = document.getElementById(toId);
      if (from && to) {
        from.classList.remove("fade-in");
        from.classList.add("fade-out");
        setTimeout(() => {
          from.style.display = "none";
          from.classList.remove("fade-out");
          to.style.display = "block";
          to.classList.add("fade-in");
          
          if (toId === 'mapView' && maps.mainMap) {
            setTimeout(() => maps.mainMap.container.fitToViewport(), 100);
          }
        }, 500);
      }
    }

    function selectRole(role) {
      localStorage.setItem('role', role);
      fadeTo("roleSelection", "authForm");
    }

    function backToRoleSelection() {
      fadeTo("authForm", "roleSelection");
    }

    function goBack(toId) {
      const visible = [...document.querySelectorAll('.container')].find(el => el.style.display !== 'none');
      if (visible) fadeTo(visible.id, toId);
    }

    function goBackFromProfile() {
      const prevScreen = localStorage.getItem('prevScreen') || (localStorage.getItem('role') === "passenger" ? "mapView" : "createRide");
      fadeTo("profileView", prevScreen);
    }

    function registerStart() {
      fadeTo("authForm", "registerForm");
    }

    function register() {
      const agreed = document.getElementById('agreementCheckbox').checked;
      if (!agreed) {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–º–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ.");
        return;
      }
      
      if (selectedUniversities.length === 0) {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤—É–∑.");
        return;
      }
      
      currentUser = {
        name: document.getElementById('fullName').value,
        phone: document.getElementById('regPhone').value,
        role: localStorage.getItem('role'),
        universities: selectedUniversities,
        tariff: null
      };
      
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      const role = localStorage.getItem('role');
      if (role === "passenger") {
        fadeTo("registerForm", "tariffSelection");
      } else {
        fadeTo("registerForm", "createRide");
      }
    }

    function selectTariff(trips, price, name) {
      selectedTariff = { trips, price, name };
      
      // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —Ç–∞—Ä–∏—Ñ–æ–≤
      document.querySelectorAll('.tariff-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      
      // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π
      event.currentTarget.classList.add('selected');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
      document.getElementById('selectedTariffInfo').style.display = 'block';
      document.getElementById('selectedTariffName').textContent = name;
      document.getElementById('selectedTariffPrice').textContent = price;
      document.getElementById('selectedTariffTrips').textContent = trips === 999 ? '–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ' : trips;
      
      // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
      document.getElementById('confirmTariffBtn').disabled = false;
    }

    function confirmTariff() {
      if (!selectedTariff) {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ");
        return;
      }
      
      if (currentUser) {
        currentUser.tariff = selectedTariff;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
      }
      
      fadeTo("tariffSelection", "mapView");
    }

    function changeTariff() {
      localStorage.setItem('prevScreen', 'profileView');
      fadeTo("profileView", "tariffSelection");
    }

    function login() {
      const storedUser = localStorage.getItem('currentUser');
      if (storedUser) {
        currentUser = JSON.parse(storedUser);
      } else {
        currentUser = {
          name: "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
          phone: "+7 XXX XXX XX XX",
          role: localStorage.getItem('role'),
          universities: ['kaznu'],
          tariff: { trips: 7, price: 3000, name: '7 –ø–æ–µ–∑–¥–æ–∫' }
        };
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
      }
      
      const role = localStorage.getItem('role');
      if (role === "passenger" && (!currentUser.tariff)) {
        fadeTo("authForm", "tariffSelection");
      } else {
        fadeTo("authForm", role === "passenger" ? "mapView" : "createRide");
      }
    }

    function showProfile() {
      const visible = [...document.querySelectorAll('.container')].find(el => el.style.display !== 'none' && el.id !== "profileView");
      if (visible) {
        localStorage.setItem('prevScreen', visible.id);
      }
      
      if (currentUser) {
        document.getElementById('userName').textContent = currentUser.name;
        document.getElementById('userPhone').textContent = currentUser.phone;
        document.getElementById('profileName').value = currentUser.name;
        document.getElementById('profilePhone').value = currentUser.phone;
        document.getElementById('userAvatar').textContent = currentUser.name.charAt(0);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –≤—É–∑—ã
        if (currentUser.universities && currentUser.universities.length > 0) {
          const uniNames = currentUser.universities.map(id => {
            const uni = universities.find(u => u.id === id);
            return uni ? uni.name : id;
          }).join(', ');
          document.getElementById('userUniversity').textContent = '–í—É–∑—ã: ' + uniNames;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∞—Ä–∏—Ñ
        if (currentUser.tariff) {
          document.getElementById('userTariff').textContent = `–¢–∞—Ä–∏—Ñ: ${currentUser.tariff.name}`;
        }
        
        if (currentUser.role === 'driver') {
          document.getElementById('driverAutoReplyItem').style.display = 'block';
        } else {
          document.getElementById('driverAutoReplyItem').style.display = 'none';
        }
      }
      
      fadeTo(visible ? visible.id : "mapView", "profileView");
    }

    function updateProfile() {
      currentUser.name = document.getElementById('profileName').value;
      currentUser.phone = document.getElementById('profilePhone').value;
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      document.getElementById('userName').textContent = currentUser.name;
      document.getElementById('userPhone').textContent = currentUser.phone;
      document.getElementById('userAvatar').textContent = currentUser.name.charAt(0);
      
      alert("–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω!");
    }

    function selectPayment(method) {
      selectedPayment = method;
      document.querySelectorAll('.payment-method').forEach(el => {
        el.classList.remove('selected');
      });
      event.currentTarget.classList.add('selected');
      alert("–í—ã–±—Ä–∞–Ω–∞ –æ–ø–ª–∞—Ç–∞: " + method);
    }

    function showPaymentMethods() {
      document.getElementById('paymentMethodsSection').style.display = 'block';
      document.getElementById('paymentMethodsSection').scrollIntoView({ behavior: 'smooth' });
    }

    function showAutoReplySettings() {
      document.getElementById('autoReplySettings').style.display = 'block';
      
      const savedSettings = localStorage.getItem('autoReplySettings');
      if (savedSettings) {
        const settings = JSON.parse(savedSettings);
        document.getElementById('autoReplyEnabled').checked = settings.enabled;
        document.getElementById('autoReplyMessage').value = settings.message;
      }
      
      document.getElementById('autoReplySettings').scrollIntoView({ behavior: 'smooth' });
    }
    
    function saveAutoReplySettings() {
      const settings = {
        enabled: document.getElementById('autoReplyEnabled').checked,
        message: document.getElementById('autoReplyMessage').value
      };
      
      localStorage.setItem('autoReplySettings', JSON.stringify(settings));
      alert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");
      document.getElementById('autoReplySettings').style.display = 'none';
    }

    function showMyRides() {
      fadeTo("profileView", "myRidesView");
    }

    function showSettings() {
      alert("–†–∞–∑–¥–µ–ª '–ù–∞—Å—Ç—Ä–æ–π–∫–∏' –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ");
    }

    function logout() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      fadeTo("profileView", "roleSelection");
    }

    function publishRide() {
      alert("–ü–æ–µ–∑–¥–∫–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞!");
      fadeTo("createRide", "mapView");
    }

    function findRides() {
      const fromLocation = document.getElementById('fromLocation').value;
      const toUniversity = document.getElementById('toUniversity').value;
      
      if (!fromLocation || !toUniversity) {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ—á–∫—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –≤—É–∑");
        return;
      }
      
      const locations = {
        'jastar': '–ñ–∞—Å—Ç–∞—Ä –∞–ø–∞—Ä—Ç–º–µ–Ω—Å',
        'almayu': '–ê–ª–º–∞—é',
        'dorm1': '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ1',
        'dorm3': '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ3',
        'dorm5': '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ5',
        'center': '–¶–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞',
        'railway': '–ñ/–¥ –≤–æ–∫–∑–∞–ª'
      };
      
      const unis = {
        'kaznu': '–ö–∞–∑–ù–£ –∏–º. –∞–ª—å-–§–∞—Ä–∞–±–∏',
        'kaznuir': '–ö–∞–∑–ù–£–ò–†',
        'kazatu': '–ö–∞–∑–ê–¢–£',
        'kaznpu': '–ö–∞–∑–ù–ü–£ –∏–º. –ê–±–∞—è',
        'kaznmu': '–ö–∞–∑–ù–ú–£',
        'kaznlu': '–ö–∞–∑–ù–õ–£',
        'iitu': 'IITU',
        'almau': 'AlmaU',
        'suleyman': '–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –°—É–ª–µ–π–º–∞–Ω–∞ –î–µ–º–∏—Ä–µ–ª—è'
      };
      
      document.getElementById('availableRides').innerHTML = `
        <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏ ${locations[fromLocation]} ‚Üí ${unis[toUniversity]}</h3>
        <div class="ride-option" style="border: 1px solid #ffcc80; padding: 15px; margin: 15px 0; border-radius: 10px;">
          <p>–í–æ–¥–∏—Ç–µ–ª—å: –ê—Å–ª–∞–Ω (‚≠ê4.9)</p>
          <p>–î–∞—Ç–∞: –°–µ–≥–æ–¥–Ω—è 08:30</p>
          <p>–°–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç: 2</p>
          <button onclick="selectRide('–ê—Å–ª–∞–Ω', 350)" style="width: 100%;">–í—ã–±—Ä–∞—Ç—å –ø–æ–µ–∑–¥–∫—É</button>
          <button onclick="openChat('–ê—Å–ª–∞–Ω')" style="width: 100%; background: #4a148c; margin-top: 5px;">–ù–∞–ø–∏—Å–∞—Ç—å –≤–æ–¥–∏—Ç–µ–ª—é</button>
        </div>
        <div class="ride-option" style="border: 1px solid #ffcc80; padding: 15px; margin: 15px 0; border-radius: 10px;">
          <p>–í–æ–¥–∏—Ç–µ–ª—å: –ú–∞—Ä–∏—è (‚≠ê5.0)</p>
          <p>–î–∞—Ç–∞: –°–µ–≥–æ–¥–Ω—è 09:00</p>
          <p>–°–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç: 3</p>
          <button onclick="selectRide('–ú–∞—Ä–∏—è', 400)" style="width: 100%;">–í—ã–±—Ä–∞—Ç—å –ø–æ–µ–∑–¥–∫—É</button>
          <button onclick="openChat('–ú–∞—Ä–∏—è')" style="width: 100%; background: #4a148c; margin-top: 5px;">–ù–∞–ø–∏—Å–∞—Ç—å –≤–æ–¥–∏—Ç–µ–ª—é</button>
        </div>
      `;
    }
    
    function selectRide(driverName, price) {
      alert(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –ø–æ–µ–∑–¥–∫—É —Å ${driverName} –∑–∞ ${price} —Ç–≥`);
    }

    function showAvailableDrivers() {
      const fromLocation = document.getElementById('fromLocation').value;
      const toUniversity = document.getElementById('toUniversity').value;
      
      if (!fromLocation || !toUniversity) {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç");
        return;
      }
      
      const locations = {
        'jastar': '–ñ–∞—Å—Ç–∞—Ä –∞–ø–∞—Ä—Ç–º–µ–Ω—Å',
        'almayu': '–ê–ª–º–∞—é',
        'dorm1': '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ1',
        'dorm3': '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ3',
        'dorm5': '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ5',
        'center': '–¶–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞',
        'railway': '–ñ/–¥ –≤–æ–∫–∑–∞–ª'
      };
      
      const unis = {
        'kaznu': '–ö–∞–∑–ù–£ –∏–º. –∞–ª—å-–§–∞—Ä–∞–±–∏',
        'kaznuir': '–ö–∞–∑–ù–£–ò–†',
        'kazatu': '–ö–∞–∑–ê–¢–£',
        'kaznpu': '–ö–∞–∑–ù–ü–£ –∏–º. –ê–±–∞—è'
      };
      
      const driverList = document.getElementById('driverList');
      driverList.innerHTML = `
        <div style="border: 1px solid #ffcc80; padding: 15px; margin: 15px 0; border-radius: 10px;">
          <h3>–ë–ª–∏–∂–∞–π—à–∏–µ –≤–æ–¥–∏—Ç–µ–ª–∏</h3>
          <p>–ú–∞—Ä—à—Ä—É—Ç: ${locations[fromLocation]} ‚Üí ${unis[toUniversity]}</p>
          <p>–í–æ–¥–∏—Ç–µ–ª—å: –ê—Å–ª–∞–Ω ‚≠ê4.9</p>
          <p>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 1.2 –∫–º</p>
          <p>–¶–µ–Ω–∞: 350 —Ç–≥</p>
          <button onclick="bookRide('–ê—Å–ª–∞–Ω', 350)" style="width: 100%;">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å</button>
        </div>
      `;
    }

    function bookRide(driverName, price) {
      alert(`–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–µ–∑–¥–∫–∞ —Å ${driverName} –∑–∞ ${price} —Ç–≥`);
    }

    function openChat(driverName) {
      chatPartner = driverName;
      document.getElementById('chatBox').style.display = 'block';
      document.getElementById('chatMessages').innerHTML = `<p><em>–ß–∞—Ç —Å –≤–æ–¥–∏—Ç–µ–ª–µ–º ${driverName} –æ—Ç–∫—Ä—ã—Ç.</em></p>`;
    }

    function sendMessage() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      if (message !== '') {
        const chatMessages = document.getElementById('chatMessages');
        const msgElement = document.createElement('p');
        msgElement.textContent = '–í—ã: ' + message;
        chatMessages.appendChild(msgElement);
        input.value = '';
        chatMessages.scrollTop = chatMessages.scrollHeight;
        
        const savedSettings = localStorage.getItem('autoReplySettings');
        if (savedSettings) {
          const settings = JSON.parse(savedSettings);
          if (settings.enabled && currentUser && currentUser.role === 'driver') {
            setTimeout(() => {
              const replyElement = document.createElement('p');
              replyElement.textContent = `${currentUser.name}: ${settings.message}`;
              chatMessages.appendChild(replyElement);
              chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 2000);
            return;
          }
        }
        
        setTimeout(() => {
          const replyElement = document.createElement('p');
          replyElement.textContent = `${chatPartner}: –°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ!`;
          chatMessages.appendChild(replyElement);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }, 1000);
      }
    }

    function viewRideDetails(rideId) {
      alert(`–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–∫–∏ #${rideId}`);
    }

    function openAgreement(event) {
      event.preventDefault();
      document.getElementById('agreementModal').style.display = 'block';
    }

    function closeAgreement() {
      document.getElementById('agreementModal').style.display = 'none';
    }
  </script>
</body>
</html>